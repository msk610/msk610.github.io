---
layout: default
title: AI Simulation World
---

<div class="simulation-game">
  <p class="mb-4">
    Start from one massive supercontinent, then watch tectonic stress split it into continents. Tune the random seed, or choose a more historically inspired split.
  </p>

  <div class="simulation-controls">
    <label for="seed-input" class="f5 text-bold mb-2">Randomness seed</label>
    <input id="seed-input" type="number" value="610" min="1" max="999999" class="form-control mb-3" />

    <label for="divide-mode" class="f5 text-bold mb-2">Continental divide style</label>
    <select id="divide-mode" class="form-select mb-3">
      <option value="historical">Historically inspired (Europe, Asia, Africa, etc.)</option>
      <option value="chaotic">Fully random split</option>
    </select>

    <button id="run-sim" class="start-adventure-button">Generate continental divide</button>
  </div>

  <canvas id="world-canvas" width="960" height="540" aria-label="Pixelated world simulation"></canvas>
  <p id="sim-status" class="mt-3 f5 text-gray">Ready to simulate.</p>
</div>

<script>
(() => {
  const canvas = document.getElementById('world-canvas');
  const ctx = canvas.getContext('2d');
  const seedInput = document.getElementById('seed-input');
  const modeInput = document.getElementById('divide-mode');
  const runButton = document.getElementById('run-sim');
  const status = document.getElementById('sim-status');

  const cols = 120;
  const rows = 68;
  const cellW = canvas.width / cols;
  const cellH = canvas.height / rows;

  const ocean = '#2d6ab8';
  const landBase = '#7a9d45';
  const palette = ['#88a94a', '#d1b76d', '#b1824c', '#9cb95f', '#8c6d3e', '#a9c47f'];

  let worldGrid = [];

  function seededRandom(seed) {
    let state = Number(seed) || 1;
    return () => {
      state = (state * 1664525 + 1013904223) % 4294967296;
      return state / 4294967296;
    };
  }

  function makeSupercontinent(rand) {
    const grid = Array.from({ length: rows }, () => Array(cols).fill(0));
    const centerX = cols / 2 + (rand() - 0.5) * 6;
    const centerY = rows / 2 + (rand() - 0.5) * 4;
    const radiusX = cols * 0.33;
    const radiusY = rows * 0.38;

    for (let y = 0; y < rows; y++) {
      for (let x = 0; x < cols; x++) {
        const dx = (x - centerX) / radiusX;
        const dy = (y - centerY) / radiusY;
        const noise = (rand() - 0.5) * 0.45;
        const value = dx * dx + dy * dy + noise;
        if (value < 1) grid[y][x] = 1;
      }
    }
    return grid;
  }

  function carveFaultLine(grid, rand, startX, endX, width, wobble) {
    let y = Math.floor(rows * (0.2 + rand() * 0.6));
    for (let x = startX; x < endX; x++) {
      y += Math.floor((rand() - 0.5) * wobble);
      y = Math.max(2, Math.min(rows - 3, y));
      for (let w = -width; w <= width; w++) {
        const yy = y + w;
        if (yy > 0 && yy < rows && grid[yy][x]) {
          grid[yy][x] = 0;
        }
      }
    }
  }

  function divideContinents(grid, rand, mode) {
    if (mode === 'historical') {
      carveFaultLine(grid, rand, Math.floor(cols * 0.24), Math.floor(cols * 0.82), 1, 2);
      carveFaultLine(grid, rand, Math.floor(cols * 0.4), Math.floor(cols * 0.9), 1, 3);
      carveFaultLine(grid, rand, Math.floor(cols * 0.1), Math.floor(cols * 0.62), 1, 2);

      for (let i = 0; i < 180; i++) {
        const x = Math.floor(cols * (0.46 + rand() * 0.12));
        const y = Math.floor(rows * (0.2 + rand() * 0.6));
        grid[y][x] = 0;
      }
    } else {
      const lines = 6 + Math.floor(rand() * 4);
      for (let i = 0; i < lines; i++) {
        const start = Math.floor(rand() * cols * 0.35);
        const end = Math.floor(cols * (0.55 + rand() * 0.45));
        carveFaultLine(grid, rand, start, end, 1 + Math.floor(rand() * 2), 4 + Math.floor(rand() * 5));
      }
    }

    for (let i = 0; i < 200; i++) {
      const x = Math.floor(rand() * cols);
      const y = Math.floor(rand() * rows);
      if (grid[y][x] && rand() < 0.15) grid[y][x] = 0;
    }
  }

  function drawWorld(progress) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = ocean;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    for (let y = 0; y < rows; y++) {
      for (let x = 0; x < cols; x++) {
        const tile = worldGrid[y][x];
        if (!tile) continue;
        const jitter = (x * 13 + y * 7) % palette.length;
        ctx.fillStyle = progress < 1 ? landBase : palette[jitter];
        ctx.fillRect(Math.floor(x * cellW), Math.floor(y * cellH), Math.ceil(cellW), Math.ceil(cellH));
      }
    }
  }

  function animateSimulation(seed, mode) {
    const rand = seededRandom(seed);
    worldGrid = makeSupercontinent(rand);
    drawWorld(0);
    status.textContent = 'Supercontinent formed... applying tectonic stress.';

    setTimeout(() => {
      divideContinents(worldGrid, rand, mode);
      let frame = 0;
      const totalFrames = 40;

      const interval = setInterval(() => {
        frame++;
        drawWorld(frame / totalFrames);

        if (frame >= totalFrames) {
          clearInterval(interval);
          status.textContent = mode === 'historical'
            ? 'Simulation complete: historically inspired continents generated.'
            : 'Simulation complete: random continental divide generated.';
        }
      }, 35);
    }, 450);
  }

  runButton.addEventListener('click', () => {
    const seed = Number(seedInput.value) || 1;
    animateSimulation(seed, modeInput.value);
  });

  animateSimulation(Number(seedInput.value) || 1, modeInput.value);
})();
</script>
